/** Convert ISO 3166-1 alpha-2 (e.g. 'GB') to flag emoji */
export const isoToFlag = (iso) => {
  if (!iso || iso.length !== 2) return '';
  const a = iso.toUpperCase().charCodeAt(0) - 65 + 0x1F1E6;
  const b = iso.toUpperCase().charCodeAt(1) - 65 + 0x1F1E6;
  return String.fromCodePoint(a, b);
};

/**
 * Country calling codes for phone input dropdown (E.164).
 * Format: { code: '+44', label: 'United Kingdom (+44)', iso: 'GB' }
 */
export const COUNTRY_CODES = [
    { code: '+44', label: 'United Kingdom (+44)', name: 'United Kingdom', iso: 'GB' },
    { code: '+1', label: 'United States / Canada (+1)', name: 'United States', iso: 'US' },
    { code: '+91', label: 'India (+91)', name: 'India', iso: 'IN' },
    { code: '+61', label: 'Australia (+61)', name: 'Australia', iso: 'AU' },
    { code: '+81', label: 'Japan (+81)', name: 'Japan', iso: 'JP' },
    { code: '+86', label: 'China (+86)', name: 'China', iso: 'CN' },
    { code: '+49', label: 'Germany (+49)', name: 'Germany', iso: 'DE' },
    { code: '+33', label: 'France (+33)', name: 'France', iso: 'FR' },
    { code: '+39', label: 'Italy (+39)', name: 'Italy', iso: 'IT' },
    { code: '+34', label: 'Spain (+34)', name: 'Spain', iso: 'ES' },
    { code: '+31', label: 'Netherlands (+31)', name: 'Netherlands', iso: 'NL' },
    { code: '+32', label: 'Belgium (+32)', name: 'Belgium', iso: 'BE' },
    { code: '+41', label: 'Switzerland (+41)', name: 'Switzerland', iso: 'CH' },
    { code: '+43', label: 'Austria (+43)', name: 'Austria', iso: 'AT' },
    { code: '+46', label: 'Sweden (+46)', name: 'Sweden', iso: 'SE' },
    { code: '+47', label: 'Norway (+47)', name: 'Norway', iso: 'NO' },
    { code: '+45', label: 'Denmark (+45)', name: 'Denmark', iso: 'DK' },
    { code: '+358', label: 'Finland (+358)', name: 'Finland', iso: 'FI' },
    { code: '+353', label: 'Ireland (+353)', name: 'Ireland', iso: 'IE' },
    { code: '+351', label: 'Portugal (+351)', name: 'Portugal', iso: 'PT' },
    { code: '+48', label: 'Poland (+48)' },
    { code: '+420', label: 'Czech Republic (+420)' },
    { code: '+36', label: 'Hungary (+36)' },
    { code: '+40', label: 'Romania (+40)' },
    { code: '+30', label: 'Greece (+30)' },
    { code: '+7', label: 'Russia / Kazakhstan (+7)' },
    { code: '+380', label: 'Ukraine (+380)' },
    { code: '+90', label: 'Turkey (+90)' },
    { code: '+971', label: 'UAE (+971)' },
    { code: '+966', label: 'Saudi Arabia (+966)' },
    { code: '+972', label: 'Israel (+972)' },
    { code: '+20', label: 'Egypt (+20)' },
    { code: '+27', label: 'South Africa (+27)' },
    { code: '+234', label: 'Nigeria (+234)' },
    { code: '+254', label: 'Kenya (+254)' },
    { code: '+255', label: 'Tanzania (+255)' },
    { code: '+233', label: 'Ghana (+233)' },
    { code: '+52', label: 'Mexico (+52)' },
    { code: '+55', label: 'Brazil (+55)' },
    { code: '+54', label: 'Argentina (+54)' },
    { code: '+56', label: 'Chile (+56)' },
    { code: '+57', label: 'Colombia (+57)' },
    { code: '+51', label: 'Peru (+51)' },
    { code: '+58', label: 'Venezuela (+58)' },
    { code: '+593', label: 'Ecuador (+593)' },
    { code: '+62', label: 'Indonesia (+62)' },
    { code: '+60', label: 'Malaysia (+60)' },
    { code: '+65', label: 'Singapore (+65)' },
    { code: '+66', label: 'Thailand (+66)' },
    { code: '+84', label: 'Vietnam (+84)' },
    { code: '+63', label: 'Philippines (+63)' },
    { code: '+64', label: 'New Zealand (+64)' },
    { code: '+82', label: 'South Korea (+82)' },
    { code: '+852', label: 'Hong Kong (+852)' },
    { code: '+853', label: 'Macau (+853)' },
    { code: '+886', label: 'Taiwan (+886)' },
    { code: '+92', label: 'Pakistan (+92)' },
    { code: '+880', label: 'Bangladesh (+880)' },
    { code: '+94', label: 'Sri Lanka (+94)' },
    { code: '+98', label: 'Iran (+98)' },
    { code: '+964', label: 'Iraq (+964)' },
    { code: '+962', label: 'Jordan (+962)' },
    { code: '+961', label: 'Lebanon (+961)' },
    { code: '+963', label: 'Syria (+963)' },
    { code: '+212', label: 'Morocco (+212)' },
    { code: '+213', label: 'Algeria (+213)' },
    { code: '+216', label: 'Tunisia (+216)' },
    { code: '+218', label: 'Libya (+218)' },
    { code: '+237', label: 'Cameroon (+237)' },
    { code: '+225', label: 'Ivory Coast (+225)' },
    { code: '+223', label: 'Mali (+223)' },
    { code: '+221', label: 'Senegal (+221)' },
    { code: '+263', label: 'Zimbabwe (+263)' },
    { code: '+260', label: 'Zambia (+260)' },
    { code: '+256', label: 'Uganda (+256)' },
    { code: '+250', label: 'Rwanda (+250)' },
    { code: '+251', label: 'Ethiopia (+251)' },
    { code: '+249', label: 'Sudan (+249)' },
    { code: '+961', label: 'Lebanon (+961)' },
    { code: '+973', label: 'Bahrain (+973)' },
    { code: '+974', label: 'Qatar (+974)' },
    { code: '+968', label: 'Oman (+968)' },
    { code: '+965', label: 'Kuwait (+965)' },
    { code: '+375', label: 'Belarus (+375)' },
    { code: '+370', label: 'Lithuania (+370)' },
    { code: '+371', label: 'Latvia (+371)' },
    { code: '+372', label: 'Estonia (+372)' },
    { code: '+381', label: 'Serbia (+381)' },
    { code: '+385', label: 'Croatia (+385)' },
    { code: '+386', label: 'Slovenia (+386)' },
    { code: '+387', label: 'Bosnia (+387)' },
    { code: '+389', label: 'North Macedonia (+389)' },
    { code: '+359', label: 'Bulgaria (+359)' },
    { code: '+355', label: 'Albania (+355)' },
    { code: '+994', label: 'Azerbaijan (+994)' },
    { code: '+995', label: 'Georgia (+995)' },
    { code: '+374', label: 'Armenia (+374)' },
    { code: '+998', label: 'Uzbekistan (+998)' },
    { code: '+996', label: 'Kyrgyzstan (+996)' },
    { code: '+993', label: 'Turkmenistan (+993)' },
    { code: '+992', label: 'Tajikistan (+992)' },
    { code: '+977', label: 'Nepal (+977)' },
    { code: '+960', label: 'Maldives (+960)' },
    { code: '+673', label: 'Brunei (+673)' },
    { code: '+855', label: 'Cambodia (+855)' },
    { code: '+856', label: 'Laos (+856)' },
    { code: '+95', label: 'Myanmar (+95)' },
    { code: '+967', label: 'Yemen (+967)' },
    { code: '+968', label: 'Oman (+968)' },
    { code: '+249', label: 'Sudan (+249)' },
    { code: '+257', label: 'Burundi (+257)' },
    { code: '+252', label: 'Somalia (+252)' },
    { code: '+253', label: 'Djibouti (+253)' },
    { code: '+258', label: 'Mozambique (+258)' },
    { code: '+261', label: 'Madagascar (+261)' },
    { code: '+230', label: 'Mauritius (+230)' },
    { code: '+248', label: 'Seychelles (+248)' },
    { code: '+269', label: 'Comoros (+269)' },
    { code: '+357', label: 'Cyprus (+357)' },
    { code: '+356', label: 'Malta (+356)' },
    { code: '+354', label: 'Iceland (+354)' },
    { code: '+298', label: 'Faroe Islands (+298)' },
    { code: '+299', label: 'Greenland (+299)' },
    { code: '+500', label: 'Falkland Islands (+500)' },
    { code: '+590', label: 'Guadeloupe (+590)' },
    { code: '+594', label: 'French Guiana (+594)' },
    { code: '+596', label: 'Martinique (+596)' },
    { code: '+687', label: 'New Caledonia (+687)' },
    { code: '+689', label: 'French Polynesia (+689)' },
    { code: '+506', label: 'Costa Rica (+506)' },
    { code: '+507', label: 'Panama (+507)' },
    { code: '+502', label: 'Guatemala (+502)' },
    { code: '+503', label: 'El Salvador (+503)' },
    { code: '+504', label: 'Honduras (+504)' },
    { code: '+505', label: 'Nicaragua (+505)' },
    { code: '+509', label: 'Haiti (+509)' },
    { code: '+1-809', label: 'Dominican Republic (+1-809)' },
    { code: '+1-787', label: 'Puerto Rico (+1-787)' },
    { code: '+1-876', label: 'Jamaica (+1-876)' },
    { code: '+1-246', label: 'Barbados (+1-246)' },
    { code: '+1-268', label: 'Antigua (+1-268)' },
    { code: '+1-649', label: 'Turks and Caicos (+1-649)' },
    { code: '+1-284', label: 'British Virgin Islands (+1-284)' },
    { code: '+1-345', label: 'Cayman Islands (+1-345)' },
    { code: '+1-473', label: 'Grenada (+1-473)' },
    { code: '+1-664', label: 'Montserrat (+1-664)' },
    { code: '+1-758', label: 'Saint Lucia (+1-758)' },
    { code: '+1-767', label: 'Dominica (+1-767)' },
    { code: '+1-784', label: 'Saint Vincent (+1-784)' },
    { code: '+1-868', label: 'Trinidad and Tobago (+1-868)' },
    { code: '+1-869', label: 'Saint Kitts (+1-869)' },
    { code: '+1-242', label: 'Bahamas (+1-242)' },
    { code: '+1-441', label: 'Bermuda (+1-441)' },
    { code: '+297', label: 'Aruba (+297)' },
    { code: '+599', label: 'Curaçao (+599)' },
    { code: '+1-264', label: 'Anguilla (+1-264)' },
    { code: '+1-670', label: 'Northern Mariana (+1-670)' },
    { code: '+1-671', label: 'Guam (+1-671)' },
    { code: '+1-684', label: 'American Samoa (+1-684)' },
    { code: '+686', label: 'Kiribati (+686)' },
    { code: '+691', label: 'Micronesia (+691)' },
    { code: '+692', label: 'Marshall Islands (+692)' },
    { code: '+680', label: 'Palau (+680)' },
    { code: '+685', label: 'Samoa (+685)' },
    { code: '+676', label: 'Tonga (+676)' },
    { code: '+679', label: 'Fiji (+679)' },
    { code: '+677', label: 'Solomon Islands (+677)' },
    { code: '+678', label: 'Vanuatu (+678)' },
    { code: '+675', label: 'Papua New Guinea (+675)' },
    { code: '+686', label: 'Kiribati (+686)' },
    { code: '+688', label: 'Tuvalu (+688)' },
    { code: '+690', label: 'Tokelau (+690)' },
    { code: '+383', label: 'Kosovo (+383)' },
    { code: '+382', label: 'Montenegro (+382)' },
    { code: '+377', label: 'Monaco (+377)' },
    { code: '+378', label: 'San Marino (+378)' },
    { code: '+379', label: 'Vatican City (+379)' },
    { code: '+423', label: 'Liechtenstein (+423)' },
    { code: '+352', label: 'Luxembourg (+352)' },
    { code: '+350', label: 'Gibraltar (+350)' },
    { code: '+44-1481', label: 'Guernsey (+44-1481)' },
    { code: '+44-1624', label: 'Isle of Man (+44-1624)' },
    { code: '+44-1534', label: 'Jersey (+44-1534)' },
    { code: '+47-79', label: 'Svalbard (+47-79)' },
    { code: '+672', label: 'Antarctica (+672)' },
    { code: '+246', label: 'Diego Garcia (+246)' },
    { code: '+290', label: 'Saint Helena (+290)' },
    { code: '+262', label: 'Réunion (+262)' },
    { code: '+596', label: 'Martinique (+596)' },
    { code: '+508', label: 'Saint Pierre (+508)' },
    { code: '+262', label: 'Mayotte (+262)' },
    { code: '+681', label: 'Wallis and Futuna (+681)' },
    { code: '+683', label: 'Niue (+683)' },
    { code: '+686', label: 'Kiribati (+686)' },
].filter((v, i, a) => a.findIndex(x => x.code === v.code) === i); // dedupe by code

/** Build E.164 full number from country code and national number digits */
export const toE164 = (countryCode, nationalNumber) => {
    const codeDigits = (countryCode || '').replace(/\D/g, '');
    const numDigits = (nationalNumber || '').replace(/\D/g, '');
    if (!codeDigits || !numDigits) return '';
    return `+${codeDigits}${numDigits}`;
};
